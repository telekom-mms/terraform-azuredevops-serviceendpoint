# terraform-template

This is a template for terraform modules.

## Usage

replace the following content from template

`.github/settings.json`

replace the following placeholder

* tpl_resources

```example
tpl_resources  = azurerm container
```

`examples/*`

replace the following placeholder

* tpl_module
* tpl_source
* tpl_local_name
* tpl_name

```example
tpl_module     = container
tpl_source     = registry.terraform.io/telekom-mms/container/azurerm
tpl_local_name = container_registry
tpl_name       = crmms
```

`main.tf`

replace the following placeholder

* tpl_provider
* tpl_module

```example
tpl_module        = container
tpl_provider      = azurerm
tpl_resource_type = azurerm_container_registry
tpl_local_name    = container_registry
```

`outputs.tf`

replace the following placeholder

* tpl_resource_type
* tpl_local_name

```example
tpl_resource_type = azurerm_container_registry
tpl_local_name    = container_registry
```

`variables.tf`

replace the following placeholder

* tpl_local_name

```example
tpl_local_name = container_registry
```

<!-- BEGIN_TF_DOCS -->
# serviceendpoint

This module manages the microsoft/azuredevops serviceendpoint resources, see https://registry.terraform.io/providers/microsoft/azuredevops/latest/docs.

For more information about the module structure see https://telekom-mms.github.io/terraform-template.

_<-- This file is autogenerated, please do not change. -->_

## Requirements

| Name | Version |
|------|---------|
| terraform | >=1.5 |
| azuredevops | >=0.6.0 |

## Providers

| Name | Version |
|------|---------|
| azuredevops | >=0.6.0 |

## Resources

| Name | Type |
|------|------|
| azuredevops_serviceendpoint_azurecr.serviceendpoint_azurecr | resource |
| azuredevops_serviceendpoint_azurerm.serviceendpoint_azurerm | resource |
| azuredevops_serviceendpoint_dockerregistry.serviceendpoint_dockerregistry | resource |
| azuredevops_serviceendpoint_generic_git.serviceendpoint_generic_git | resource |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| serviceendpoint_azurecr | Resource definition, default settings are defined within locals and merged with var settings. For more information look at [Outputs](#Outputs). | `any` | `{}` | no |
| serviceendpoint_azurerm | Resource definition, default settings are defined within locals and merged with var settings. For more information look at [Outputs](#Outputs). | `any` | `{}` | no |
| serviceendpoint_dockerregistry | Resource definition, default settings are defined within locals and merged with var settings. For more information look at [Outputs](#Outputs). | `any` | `{}` | no |
| serviceendpoint_generic_git | Resource definition, default settings are defined within locals and merged with var settings. For more information look at [Outputs](#Outputs). | `any` | `{}` | no |

## Outputs

| Name | Description |
|------|-------------|
| serviceendpoint_azurecr | Outputs all attributes of resource_type. |
| serviceendpoint_azurerm | Outputs all attributes of resource_type. |
| serviceendpoint_dockerregistry | Outputs all attributes of resource_type. |
| serviceendpoint_generic_git | Outputs all attributes of resource_type. |
| variables | Displays all configurable variables passed by the module. __default__ = predefined values per module. __merged__ = result of merging the default values and custom values passed to the module |

## Examples

Minimal configuration to install the desired resources with the module

```hcl
data "azurerm_subscription" "current" {}

module "container" {
  source = "registry.terraform.io/telekom-mms/container/azurerm"
  container_registry = {
    crmms = {
      location            = "westeurope"
      resource_group_name = "rg-mms-github"
    }
  }
}

module "core" {
  source = "registry.terraform.io/telekom-mms/core/azuredevops"
  project = {
    mms = {}
  }
}

module "serviceendpoint" {
  source = "registry.terraform.io/telekom-mms/serviceendpoint/azuredevops"
  serviceendpoint_azurerm = {
    mms = {
      project_id                = module.core.project["mms"].id
      azurerm_subscription_id   = data.azurerm_subscription.current.subscription_id
      azurerm_subscription_name = data.azurerm_subscription.current.display_name
      azurerm_spn_tenantid      = data.azurerm_subscription.current.tenant_id
    }
  }
  serviceendpoint_azurecr = {
    crmms = {
      project_id                = module.core.project["mms"].id
      resource_group            = module.container.container_registry["crmms"].resource_group_name
      azurecr_spn_tenantid      = data.azurerm_subscription.current.tenant_id
      azurecr_name              = module.container.container_registry["crmms"].name
      azurecr_subscription_id   = data.azurerm_subscription.current.subscription_id
      azurecr_subscription_name = data.azurerm_subscription.current.display_name
    }
  }
  serviceendpoint_dockerregistry = {
    crdocker = {
      project_id = module.core.project["mms"].id
    }
  }
  serviceendpoint_generic_git = {
    github = {
      project_id     = module.core.project["mms"].id
      repository_url = "https://github.com/telekom-mms/terraform-template"
    }
  }
}
```

Advanced configuration to install the desired resources with the module

```hcl
data "azurerm_subscription" "current" {}

module "container" {
  source = "registry.terraform.io/telekom-mms/container/azurerm"
  container_registry = {
    crmms = {
      location            = "westeurope"
      resource_group_name = "rg-mms-github"
    }
  }
}

module "core" {
  source = "registry.terraform.io/telekom-mms/core/azuredevops"
  project = {
    mms = {}
  }
}

module "serviceendpoint" {
  source = "../terraform-azuredevops-serviceendpoint"
  serviceendpoint_azurerm = {
    mms = {
      project_id                = module.core.project["mms"].id
      azurerm_subscription_id   = data.azurerm_subscription.current.subscription_id
      azurerm_subscription_name = data.azurerm_subscription.current.display_name
      azurerm_spn_tenantid      = data.azurerm_subscription.current.tenant_id
      description               = "Azure Resource Manager Connection"
    }
  }
  serviceendpoint_azurecr = {
    crmms = {
      project_id                = module.core.project["mms"].id
      resource_group            = module.container.container_registry["crmms"].resource_group_name
      azurecr_spn_tenantid      = data.azurerm_subscription.current.tenant_id
      azurecr_name              = module.container.container_registry["crmms"].name
      azurecr_subscription_id   = data.azurerm_subscription.current.subscription_id
      azurecr_subscription_name = data.azurerm_subscription.current.display_name
      description               = "Azure Container Registry Connection"
    }
  }
  serviceendpoint_dockerregistry = {
    docker = {
      project_id  = module.core.project["mms"].id
      description = "Docker Registry Connection"
    }
  }
  serviceendpoint_generic_git = {
    github = {
      project_id              = module.core.project["mms"].id
      repository_url          = "https://github.com/telekom-mms/terraform-template"
      description             = "GitHub Repository Connection for terraform template"
      enable_pipelines_access = "true"
    }
  }
}
```
<!-- END_TF_DOCS -->